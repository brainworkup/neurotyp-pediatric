import anthropic

client = anthropic.Anthropic(
    # defaults to os.environ.get("ANTHROPIC_API_KEY")
    api_key="my_api_key",
)

# Replace placeholders like {{FILE}} with real values,
# because the SDK does not support variables.
message = client.messages.create(
    model="claude-3-7-sonnet-20250219",
    max_tokens=20000,
    temperature=1,
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "You are a board-certified clinical neuropsychologist tasked with creating a professional summary of a patient's neurocognitive assessment results. Your goal is to provide a concise, clinically relevant interpretation that focuses on real-world functional implications.\n\nHere is the information you need to analyze:\n\nFile name: <file_name>{{FILE}}</file_name>\nPatient name: <patient_name>{{NAME}}</patient_name>\nPatient pronouns: <patient_pronouns>{{PRONOUNS}}</patient_pronouns>\nAssessment domain: <assessment_domain>{{DOMAIN}}</assessment_domain>\n\nPlease carefully review this information and create a summary following these guidelines:\n\n1. Format Requirements:\n   - Write a single paragraph in third-person, past tense.\n   - Capitalize the first letter of performance range descriptors (e.g., \"Below Average,\" \"Average,\" \"Above Average\").\n   - Omit specific test scores such as standard scores, t scores, and scaled scores.\n   - Use percentile scores sparingly, only when presenting meaningful or extreme percentile information.\n\n2. Content Focus:\n   - Translate assessment results into practical real-world implications (e.g., school, work, home, social settings).\n   - Interpret findings in terms of everyday functioning.\n   - Emphasize how performance relates to real-world settings.\n   - Highlight significant strengths and weaknesses, with less emphasis on average-range scores.\n\n3. Style Guidelines:\n   - Maintain a professional clinical tone.\n   - Use concise language.\n   - Ensure grammatical correctness.\n   - Avoid simply restating test names and their standard descriptions.\n\nBefore writing your final summary, wrap your analysis inside <neurocognitive_assessment_analysis> tags in your thinking block:\n1. List key findings from each subdomain of the assessment.\n2. For each finding, brainstorm potential real-world implications.\n3. Identify the most significant strengths and weaknesses.\n4. Draft initial sentences for the summary, focusing on real-world implications.\n5. Review and refine the summary to ensure it meets all requirements and reflects the expertise of a board-certified clinical neuropsychologist.\n\nAfter your analysis, provide your final summary in <summary> tags.\n\nExample output structure (note: this is a generic example and should not influence the content of your actual summary):\n\n<summary>\n[Patient name] underwent neurocognitive assessment in the domain of [assessment domain]. [He/She/They] demonstrated [Strength] in [specific area], which suggests [real-world implication]. However, [his/her/their] performance was [Weakness] in [specific area], potentially impacting [real-world function]. Overall, [patient name]'s cognitive profile indicates [broad conclusion about functioning in everyday life].\n</summary>\n\nYour final output should consist only of the summary and should not duplicate or rehash any of the work you did in the neurocognitive assessment analysis."
                }
            ]
        },
        {
            "role": "assistant",
            "content": [
                {
                    "type": "text",
                    "text": "<neurocognitive_assessment_analysis>\nLet me analyze the assessment results for Biggie in the domain of ADHD/Executive Functioning:\n\n1. Key findings by subdomain:\n\nExecutive Function (CEFI Parent):\n- Overall Executive Functioning: Low Average (10th percentile)\n- Attention: Exceptionally Low (1st percentile)\n- Working Memory: Exceptionally Low (1st percentile)\n- Organization: Below Average (3rd percentile)\n- Initiation: Below Average (5th percentile)\n- Planning: Low Average (19th percentile)\n- Self-Monitoring: Low Average (13th percentile)\n- Flexibility: Average (42nd percentile)\n- Emotion Regulation: Average (58th percentile)\n- Inhibitory Control: High Average (82nd percentile)\n\nADHD Symptoms (Conners-4 Parent):\n- Inattention/Executive Dysfunction: High Average (87th percentile)\n- ADHD Inattentive Symptoms: High Average (87th percentile)\n- Total ADHD Symptoms: High Average (80th percentile)\n- Hyperactivity: Average (61st percentile)\n- ADHD Hyperactive/Impulsive Symptoms: Average (58th percentile)\n- Impulsivity: Below Average (7th percentile)\n- Emotional Dysregulation: Low Average (12th percentile)\n\nFunctional Impairment:\n- Schoolwork: High Average (90th percentile) - indicates significant impairment\n- Peer Interactions: Low Average (18th percentile)\n- Family Life: Average (47th percentile)\n\nADHD Index:\n- 74% probability of having ADHD\n\n2. Real-world implications:\n\nAttention/Working Memory deficits (Exceptionally Low):\n- Difficulty sustaining attention during lectures, conversations, or extended tasks\n- Trouble remembering multi-step instructions\n- Likely misses details in assignments\n- May appear to not listen when spoken to directly\n- Difficulty holding information in mind while completing tasks\n\nOrganization/Initiation difficulties (Below Average):\n- Struggles with starting homework or projects independently\n- Difficulty keeping track of materials, assignments, and belongings\n- Problems with time management and planning out complex tasks\n- May appear unmotivated when actually struggling with initiation\n\nPlanning/Self-Monitoring weaknesses (Low Average):\n- Challenges in breaking down large assignments into manageable steps\n- Difficulty checking work for errors\n- Limited ability to adjust approach when not successful\n- May rush through work without verifying accuracy\n\nInhibitory Control strength (High Average):\n- Better-than-expected ability to control behavior and avoid inappropriate responses\n- Can typically think before acting in social situations\n- Able to consider consequences before taking action\n\nAcademic impact (High Average impairment):\n- Significant difficulties completing and submitting assignments on time\n- Struggles with checking work for errors\n- Problems with losing homework and materials\n\n3. Most significant strengths and weaknesses:\n\nSignificant weaknesses:\n- Attention and working memory (1st percentile) - severely impacting learning and task completion\n- Organization (3rd percentile) - affecting ability to manage materials and assignments\n- Initiation (5th percentile) - creating barriers to starting and completing tasks\n- Schoolwork impairment (90th percentile) - resulting in academic difficulties\n\nRelative strengths:\n- Inhibitory Control (82nd percentile) - providing better behavioral regulation than typical for ADHD\n- Emotion Regulation (58th percentile) - suggesting adequate ability to manage emotions\n\n4. Initial summary sentences:\n\nBiggie underwent assessment for ADHD and executive functioning concerns, with results indicating a profile consistent with an ADHD presentation predominantly characterized by inattention. His exceptionally low attention and working memory abilities (1st percentile) significantly impact his capacity to sustain focus during academic tasks and retain multi-step instructions. Despite having adequate behavioral control and emotional regulation, Biggie demonstrates marked difficulties with organization (3rd percentile) and initiation (5th percentile), which manifests as challenges maintaining an organized workspace, keeping track of assignments, and independently starting tasks. His relative strengths in inhibitory control (82nd percentile) suggest he has better-than-expected ability to control impulsive behaviors, but this does not offset his substantial difficulties with academic tasks as evidenced by significant functional impairment in schoolwork (90th percentile).\n\n5. Refined summary:\n\nBiggie's assessment reveals a pattern of executive functioning challenges consistent with an inattentive presentation of ADHD (74% probability). His most pronounced difficulties involve attention, working memory, organization, and task initiation, which significantly impact his academic functioning. Despite adequate emotional regulation and above-average inhibitory control, Biggie struggles substantially with starting tasks independently, keeping track of materials, and sustaining attention through completion of assignments. These executive functioning deficits create barriers to academic success despite potentially adequate understanding of subject matter. His profile suggests he would benefit from targeted interventions addressing these specific executive function challenges within the classroom and home environments.\n</neurocognitive_assessment_analysis>\n\n<summary>\nBiggie underwent neurocognitive assessment in the domain of ADHD/Executive Functioning. His performance revealed significant weaknesses in attention and working memory (1st percentile), creating substantial difficulties sustaining focus during academic tasks and following multi-step instructions. Biggie demonstrated pronounced challenges with organization (3rd percentile) and task initiation (5th percentile), which manifested as struggles maintaining an organized workspace, tracking assignments, and independently starting schoolwork. These executive functioning deficits resulted in significant academic impairment (90th percentile), including incomplete assignments and poor work completion. In contrast, Biggie demonstrated relative strengths in inhibitory control (82nd percentile) and emotional regulation (Average range), suggesting better-than-expected ability to control impulsive behaviors and manage emotions compared to others with similar attentional difficulties. Overall, his profile was consistent with an inattentive presentation of ADHD, with executive functioning challenges that primarily impact academic performance despite adequate cognitive capabilities.\n</summary>"
                }
            ]
        }
    ]
)
print(message.content)
